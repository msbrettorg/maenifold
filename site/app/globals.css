@import "tailwindcss";

/* T-SITE-001.2: RTM FR-15.x — Design System: Warm Restraint */

@theme {
  --color-bg: var(--bg);
  --color-bg-surface: var(--bg-surface);
  --color-bg-hover: var(--bg-hover);
  --color-border: var(--border);
  --color-text: var(--text);
  --color-text-secondary: var(--text-secondary);
  --color-accent: var(--accent);
  --color-accent-hover: var(--accent-hover);
  --color-accent-muted: var(--accent-muted);
  --color-code-bg: var(--code-bg);
  --color-code-text: var(--code-text);
}

@layer base {
  /* Dark mode — default (:root) */
  :root {
    --bg:               #1c1c1c;
    --bg-surface:       #252525;
    --bg-hover:         #2d2d2d;
    --border:           #383838;
    --text:             #e0dbd6;
    --text-secondary:   #908a85;
    --accent:           #6AABB3;
    --accent-hover:     #8AC0C6;
    --accent-muted:     #1e2e30;
    --code-bg:          #1a1a1a;
    --code-text:        #d0cac4;
    --code-comment:     #7a7570;
  }

  /* Light mode — explicit .light class on <html> */
  .light {
    --bg:               #f5f2ee;
    --bg-surface:       #ffffff;
    --bg-hover:         #eae6e1;
    --border:           #d8d3cd;
    --text:             #1c1c1c;
    --text-secondary:   #757069;
    --accent:           #3A8A94;
    --accent-hover:     #2A7A84;
    --accent-muted:     #D0E8EA;
    --code-bg:          #f2efeb;
    --code-text:        #1c1c1c;
  }

  /* Light mode — OS preference fallback (no explicit dark override) */
  @media (prefers-color-scheme: light) {
    :root:not(.dark) {
      --bg:               #f5f2ee;
      --bg-surface:       #ffffff;
      --bg-hover:         #eae6e1;
      --border:           #d8d3cd;
      --text:             #1c1c1c;
      --text-secondary:   #757069;
      --accent:           #3A8A94;
      --accent-hover:     #2A7A84;
      --accent-muted:     #D0E8EA;
      --code-bg:          #f2efeb;
      --code-text:        #1c1c1c;
    }
  }

  /* Typography — body */
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
      'Helvetica Neue', Arial, sans-serif;
    font-size: 16px;
    line-height: 1.75;
    color: var(--text);
    background-color: var(--bg);
  }

  /* Grain texture overlay — feTurbulence noise at 3% opacity */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9999;
    opacity: 0.03;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    background-repeat: repeat;
  }

  /* Monospace — code, pre, kbd */
  code, pre, kbd {
    font-family: ui-monospace, 'Cascadia Code', 'SF Mono', Menlo, Consolas,
      'Liberation Mono', monospace;
    font-size: 14px;
    line-height: 1.6;
  }

  /* Headings — Newsreader serif via next/font CSS variable */
  h1, h2, h3 {
    font-family: var(--font-heading), Georgia, 'Times New Roman', serif;
  }
  h1 { font-size: 32px; font-weight: 400; letter-spacing: -0.01em; }
  h2 { font-size: 26px; font-weight: 400; }
  h3 { font-size: 21px; font-weight: 500; }

  /* Links */
  a { color: var(--accent); text-decoration: underline; text-decoration-color: color-mix(in srgb, var(--accent) 40%, transparent); text-underline-offset: 2px; }
  a:hover { color: var(--accent-hover); text-decoration-color: var(--accent-hover); }

  /* Focus indicator — WCAG 2.4.7 */
  :focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 3px;
  }
}

/* Layout utilities */
.prose-width    { max-width: 72ch; margin-inline: auto; }
.code-width     { max-width: 900px; margin-inline: auto; }
.section-gap    { margin-block: 5rem; }
.subsection-gap { margin-block: 3rem; }

/* T-SITE-001.2a: RTM FR-15.10, NFR-15.5 — Markdown content styles */
.markdown-content h1 { margin-block: 2rem 1rem; }
.markdown-content h2 { margin-block: 3rem 1rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem; }
.markdown-content h3 { margin-block: 2rem 0.75rem; }
.markdown-content p { margin-block: 1.5rem; }
.markdown-content ul, .markdown-content ol { margin-block: 1rem; padding-left: 2rem; }
.markdown-content li { margin-block: 0.25rem; }
.markdown-content table { width: 100%; border-collapse: collapse; margin-block: 1.5rem; }
.markdown-content th, .markdown-content td { padding: 0.75rem 1rem; border: 1px solid var(--border); text-align: left; }
.markdown-content th { background-color: var(--bg-surface); font-weight: 600; }
.markdown-content blockquote { border-left: 3px solid var(--accent); padding-left: 1rem; color: var(--text-secondary); margin-block: 1.5rem; }
.markdown-content a {
  text-decoration: underline;
  text-decoration-color: color-mix(in srgb, var(--accent) 50%, transparent);
  text-underline-offset: 3px;
}
.markdown-content a:hover {
  text-decoration-color: var(--accent);
}

.code-block { position: relative; margin-block: 1.5rem; border-radius: 8px; overflow: hidden; }
.code-block pre { padding: 1.25rem; overflow-x: auto; background-color: var(--code-bg) !important; }

.mermaid-diagram { margin-block: 2rem; text-align: center; }
.mermaid-diagram svg { max-width: 100%; height: auto; }

/* T-SITE-001.20: Homepage features — two-column glossary */
.features-glossary {
  margin: 0;
  columns: 2;
  column-gap: 3rem;
}
.features-entry {
  break-inside: avoid;
  margin-bottom: 1.75rem;
}
.features-entry dt {
  font-weight: 600;
  font-size: 1.0625rem;
}
.features-entry dd {
  margin: 0.25rem 0 0;
  color: var(--text-secondary);
  line-height: 1.75;
}
@media (max-width: 640px) {
  .features-glossary { columns: 1; }
}

/* T-SITE-001.20: Full-bleed graph break — editorial image divider */
.graph-break {
  position: relative;
  margin-block: 5rem;
  background: #141414;
  overflow: hidden;
}
.graph-break img {
  display: block;
  width: 100%;
  height: 55vh;
  min-height: 300px;
  max-height: 550px;
  object-fit: cover;
}
.graph-break::before,
.graph-break::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  height: 100px;
  z-index: 1;
  pointer-events: none;
}
.graph-break::before {
  top: 0;
  background: linear-gradient(to bottom, var(--bg), transparent);
}
.graph-break::after {
  bottom: 0;
  background: linear-gradient(to top, var(--bg), transparent);
}

/* T-SITE-001.20: Section container — 900px left-aligned content */
.section-container {
  max-width: 900px;
  margin-inline: auto;
  padding-inline: 1rem;
}

/* T-SITE-001.21: Docs two-column layout — sidebar + content */
.docs-layout {
  display: flex;
  max-width: 1100px;
  margin-inline: auto;
  padding: 2rem 1rem 5rem;
  gap: 3rem;
}

.docs-sidebar {
  position: sticky;
  top: 68px;  /* header height (52px) + 16px breathing room */
  align-self: flex-start;
  width: 220px;
  min-width: 220px;
  max-height: calc(100vh - 84px);
  overflow-y: auto;
  padding-right: 0.5rem;

  /* Subtle scrollbar */
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

.docs-sidebar a:hover {
  color: var(--text) !important;
  text-decoration: none;
}

.docs-content {
  flex: 1;
  min-width: 0;  /* prevent flex blowout from code blocks */
  max-width: 72ch;
}

/* Docs page title — the first h1 gets editorial treatment */
.docs-content > div > h1:first-child {
  font-size: 2.25rem;
  font-weight: 400;
  letter-spacing: -0.015em;
  color: var(--accent);
  margin-bottom: 0.5rem;
}

/* Docs opening tagline (bold paragraph immediately after h1) */
.docs-content > div > p:first-of-type {
  font-size: 1.125rem;
  color: var(--text-secondary);
  margin-bottom: 2rem;
}

/* Horizontal rules — deliberate section breathing space */
.docs-content hr {
  border: none;
  height: 1px;
  background: var(--border);
  margin-block: 3.5rem;
}

/* Code blocks inside docs should not exceed content width */
.docs-content .code-block { max-width: 100%; }
.docs-content .code-width { max-width: 100%; margin-inline: 0; }

/* Tables inside docs — tighter type, horizontal scroll on overflow */
.docs-content table {
  display: block;
  overflow-x: auto;
  font-size: 0.9375rem;
  line-height: 1.6;
}
.docs-content th, .docs-content td {
  white-space: normal;
  word-break: break-word;
}
.docs-content code {
  font-size: 0.8125rem;
  white-space: nowrap;
}

/* Collapse sidebar on narrow viewports */
@media (max-width: 860px) {
  .docs-layout {
    flex-direction: column;
    gap: 0;
  }
  .docs-sidebar {
    position: static;
    width: 100%;
    min-width: 0;
    max-height: none;
    border-bottom: 1px solid var(--border);
    padding-bottom: 1.5rem;
    margin-bottom: 2rem;
  }
}

/* T-SITE-001.23: Homepage flywheel — vertical narrative steps */
.flywheel-steps {
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: 0;
}
.flywheel-step {
  padding: 2rem 0;
  border-top: 1px solid var(--border);
}
.flywheel-step:last-child {
  border-bottom: 1px solid var(--border);
}
.flywheel-step dt {
  font-weight: 600;
  font-size: 1.125rem;
  margin-bottom: 0.5rem;
}
.flywheel-step dd {
  margin: 0;
  color: var(--text-secondary);
  line-height: 1.8;
  max-width: 60ch;
}
.flywheel-step code {
  color: var(--accent);
  font-size: 0.875rem;
}

/* T-SITE-001.23: Architecture layers table */
.layers-table-wrap {
  overflow-x: auto;
}
.layers-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9375rem;
  line-height: 1.6;
}
.layers-table th {
  text-align: left;
  padding: 0.75rem 1rem;
  border-bottom: 2px solid var(--border);
  font-weight: 600;
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-secondary);
}
.layers-table td {
  padding: 0.75rem 1rem;
  border-bottom: 1px solid var(--border);
  vertical-align: top;
}
.layers-table td:first-child {
  white-space: nowrap;
  width: 110px;
}
.layers-table td code {
  font-size: 0.8125rem;
  color: var(--accent);
  background: var(--bg-hover);
  padding: 0.1em 0.4em;
  border-radius: 3px;
  margin-right: 0.25rem;
  white-space: nowrap;
}
.layers-table td:last-child {
  color: var(--text-secondary);
}

/* T-SITE-001.23: Built with maenifold — proof list */
.built-with-list {
  display: flex;
  flex-direction: column;
  gap: 0;
}
.built-with-item {
  padding: 2.5rem 0;
  border-top: 1px solid var(--border);
}
.built-with-item:last-child {
  border-bottom: 1px solid var(--border);
}
.built-with-meta {
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--accent);
  margin-bottom: 0.5rem;
}
.built-with-item h3 {
  font-family: var(--font-heading), Georgia, 'Times New Roman', serif;
  font-size: 1.25rem;
  font-weight: 400;
  margin: 0 0 0.75rem;
}
.built-with-item > p {
  color: var(--text-secondary);
  line-height: 1.75;
  margin: 0 0 1rem;
  max-width: 60ch;
}
.built-with-item code {
  color: var(--accent);
  font-size: 0.875rem;
}
.built-with-stats {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 0.5rem;
  font-size: 0.9375rem;
  font-weight: 500;
  margin-bottom: 0.75rem;
}
.built-with-divider {
  color: var(--text-secondary);
  font-weight: 300;
}
.built-with-downloads {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  margin-top: 0.25rem;
}
.built-with-downloads a {
  font-size: 0.8125rem;
  color: var(--accent);
  text-decoration: none;
  padding: 0.25rem 0.625rem;
  border: 1px solid color-mix(in srgb, var(--accent) 30%, transparent);
  border-radius: 4px;
  transition: border-color 0.15s;
}
.built-with-downloads a:hover {
  border-color: var(--accent);
  text-decoration: none;
}
.built-with-output {
  font-size: 0.875rem;
  color: var(--text-secondary);
  line-height: 1.7;
  max-width: 60ch;
}

/* T-SITE-001.23: Badge row for hero and install sections */
.badge-row { display: flex; flex-wrap: wrap; align-items: center; gap: 0.75rem; margin-top: 1.5rem; }
.badge-row img { height: 20px; }

/* T-SITE-001.23: Graph break caption */
.graph-break figcaption {
  position: absolute; bottom: 1.5rem; left: 50%; transform: translateX(-50%);
  z-index: 2; font-size: 0.875rem; color: var(--text-secondary); text-align: center;
}

/* T-SITE-001.23: Guided next steps */
.next-steps { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; margin-top: 1.5rem; }
.next-steps a { display: block; padding: 1.5rem; border: 1px solid var(--border); border-radius: 8px; text-decoration: none; transition: border-color 0.15s; }
.next-steps a:hover { border-color: var(--accent); text-decoration: none; }
.next-steps h3 { margin: 0 0 0.5rem; font-size: 1.0625rem; }
.next-steps p { margin: 0; color: var(--text-secondary); font-size: 0.9375rem; }
@media (max-width: 640px) { .next-steps { grid-template-columns: 1fr; } }

@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    transition-duration: 0s !important;
    animation-duration: 0s !important;
  }
}
