{
  "id": "sleep-cycle",
  "name": "Cognitive Sleep Cycle (Orchestrator)",
  "emoji": "üåô",
  "description": "Multi-agent orchestration for memory consolidation, decay processing, and graph maintenance during agent sleep. Dispatches 4 parallel specialist workflows that mirror biological sleep phases.",
  "triggers": [
    "sleep cycle",
    "memory consolidation",
    "cognitive maintenance",
    "graph maintenance",
    "custodian",
    "sleep"
  ],
  "enhancedThinkingEnabled": true,
  "steps": [
    {
      "id": "dispatch-specialists",
      "name": "üöÄ Dispatch Sleep Specialists",
      "description": "üö´ BLOCKING: Dispatch ALL specialist workflows in ONE message for parallel execution.\n\n‚ö†Ô∏è CRITICAL: ALL FOUR AGENTS IN ONE MESSAGE FOR PARALLEL EXECUTION!\n\n```\n# DISPATCH ALL IN ONE MESSAGE:\n\nTask 1: Run sleep-consolidation workflow\nAgent: Run workflow sleep-consolidation\nInstruction: Execute the consolidation workflow: memory replay focused on high-significance events, slow-wave consolidation of episodic to semantic memory, and dream synthesis for novel connections.\nOutput: memory://custodian/consolidation-{timestamp}/\n\nTask 2: Run sleep-decay workflow\nAgent: Run workflow sleep-decay\nInstruction: Execute the decay workflow: analyze access patterns, calculate tiered decay weights, flag severely decayed content for review.\nOutput: memory://custodian/decay-{timestamp}/\n\nTask 3: Run sleep-repair workflow\nAgent: Run workflow sleep-repair\nInstruction: Execute the repair workflow: analyze concept corruption in high-frequency families, normalize WikiLink variants, sync graph.\nOutput: memory://custodian/repair-{timestamp}/\n\nTask 4: Run sleep-epistemic workflow\nAgent: Run workflow sleep-epistemic\nInstruction: Execute the epistemic workflow: review active assumptions, apply validation pressure, update statuses based on evidence.\nOutput: memory://custodian/epistemic-{timestamp}/\n```\n\nüéØ SPECIALIST REQUIREMENTS:\n- Each specialist workflow is self-contained with its own memory replay phase\n- Consolidation: MAY use read_memory (access boosting is semantically correct)\n- Decay: SHALL use list_memories, NOT read_memory (preserve decay state)\n- Repair: SHALL use graph tools, NOT read_memory\n- Epistemic: SHALL use assumption_ledger, NOT read_memory\n\n‚è±Ô∏è Dispatch duration: 5 minutes\n‚è±Ô∏è Specialist execution: 30-45 minutes each (parallel)",
      "requiresEnhancedThinking": false,
      "metadata": {
        "toolHints": {
          "Task": {
            "reason": "Critical parallel dispatch - ALL agents must launch in ONE message",
            "priority": "mandatory",
            "required_operations": ["sleep-consolidation workflow", "sleep-decay workflow", "sleep-repair workflow", "sleep-epistemic workflow"],
            "parallel_execution": true,
            "agent_instructions": {
              "workflow_choice": "Each specialist runs its designated workflow",
              "output_format": "Markdown report to designated memory://custodian/ folder"
            }
          }
        },
        "reasoning_effort": "low",
        "stop_conditions": ["All four specialists dispatched"],
        "next_actions": ["Wait for specialists", "Review outputs"],
        "guardrails": {
          "tool_access_safety": "Consolidation MAY use read_memory; others MUST NOT (NFR-7.11.x)"
        }
      }
    },
    {
      "id": "review-outputs",
      "name": "üìä Review Specialist Outputs",
      "description": "Review all outputs from the 4 specialist workflows.\n\n1. **Read Consolidation Report**:\n   - memory://custodian/consolidation-{timestamp}/\n   - Check: Items consolidated, WikiLink density, dream insights\n\n2. **Read Decay Report**:\n   - memory://custodian/decay-{timestamp}/\n   - Check: Decay statistics, flagged items, tier breakdown\n\n3. **Read Repair Report**:\n   - memory://custodian/repair-{timestamp}/\n   - Check: Repairs made, items flagged for human review, graph health\n\n4. **Read Epistemic Report**:\n   - memory://custodian/epistemic-{timestamp}/\n   - Check: Assumptions reviewed, status changes, evidence cited\n\n5. **Compile Status**:\n   - Success/failure for each specialist\n   - Aggregate metrics (items processed, issues found)\n   - Flag any specialists that need re-run\n\n‚è±Ô∏è Duration: 10-15 minutes",
      "requiresEnhancedThinking": false,
      "metadata": {
        "toolHints": {
          "read_memory": {
            "reason": "Read all specialist output reports",
            "priority": "mandatory"
          }
        },
        "reasoning_effort": "medium",
        "stop_conditions": ["All reports reviewed", "Status compiled"],
        "next_actions": ["Wake preparation"],
        "guardrails": {
          "completeness_check": "All 4 specialists must have produced output"
        }
      }
    },
    {
      "id": "wake-preparation",
      "name": "üåÖ Wake Preparation",
      "description": "Prepare enriched context for next session.\n\n1. **Summarize Sleep Cycle Outcomes**:\n   - Consolidations performed\n   - Decay state changes\n   - Graph repairs completed\n   - Assumption status updates\n\n2. **Identify Priority Items**:\n   - Items flagged for human review\n   - Unresolved repair candidates\n   - Assumptions needing validation\n   - Dream insights worth exploring\n\n3. **Prepare Context Injection**:\n   - Compile concise wake-up context (<2000 tokens)\n   - Include key insights and priorities\n   - Note any sleep cycle issues\n\n4. **Log Cycle Metrics**:\n   - Total items processed per phase\n   - Time spent per specialist\n   - Errors or retries needed\n\nOutput: memory://custodian/wake-context-{timestamp}.md\nInclude: Cycle summary, priority items, context injection payload",
      "requiresEnhancedThinking": false,
      "metadata": {
        "toolHints": {
          "write_memory": {
            "reason": "Document wake context",
            "priority": "mandatory"
          },
          "sequential_thinking": {
            "reason": "Synthesize specialist outputs into coherent summary",
            "priority": "recommended",
            "estimated_thoughts": 2,
            "focus_areas": ["Outcome synthesis", "Priority identification"]
          }
        },
        "reasoning_effort": "low",
        "stop_conditions": ["Summary complete", "Context prepared"],
        "next_actions": ["Sleep cycle complete"],
        "guardrails": {
          "context_size": "Wake context should be concise (<2000 tokens)"
        }
      }
    }
  ]
}
